---
title: https
date: 2023-07-04 09:50:30
tags:
  - https
categories:
  - 笔记
---

# 参考资料

[HTTPS原理和TLS认证流程全解析 - 知乎 (zhihu.com)](https://zhuanlan.zhihu.com/p/440612523)

# HTTPS协议

http协议是明文传输，内容容易被中间人拦截后获取，且中间人可伪装为服务器，向客户端发送伪装的响应。

https在http应用层和tcp传输层中间加了一层SSL安全层，整个加密过程都没有侵入原先的http协议，故对http协议进行了很好的兼容。

# TLS/SSL

TLS协议就是SSL协议，SSL在被网景公司（Netscape）开发出来后，在SSL3.0的下一个版本便是TLS1.0，在此之后迭代TLS1.0、1.1、1.2和1.3，目前应用最广泛的为TLS1.2。

## TLS加密原理

类似于TCP会通过握手来建立连接，TLS也会通过握手来交换一些必要的基础信息。

既然TLS是为了保证传输安全，那肯定要对传输的数据进行加密，加密的方式一般有对称加密和非对称加密。

对称加密加密和解密都用的同一个密钥，由于CS方式的特殊性，如果采用对称加密，则会存在问题：是否所有客户端和服务端都用同一个密钥呢，当然如果这样做的话，则完全没有加密的必要了，因为任何一台客户端都可以用该密钥去截取其他客户端的信息。那如果每一对连接都是用不同的对称密钥呢？那对称密钥的首次传输也是个问题，不经过处理的话，首次传输的对称密钥也会被人截取。所以TLS同时采用了非对称加密方式来保护首次传输的对称密钥。

非对称加密，加密和解密的密钥是不同的，公钥会公布给各客户端用于加密信息，而私钥则会用于在服务端的数据解密操作。客户端可以生成一个对称密钥用于后续使用，但首次传输时会使用服务端提供的公钥将对称密钥进行加密传输给服务端。

那为何不全程使用非对称加密呢，原因是非对称的加解密操作很耗时，不如对称加密来的快。

那么服务端只需要将公钥发送给客户端，即可在后续的连接中使用客户端定义的对称密钥进行加密的信息传输。但紧接着有一个问题：如何判断这个公钥就是服务端的公钥而不是中间人产生的公钥呢？

## 数字证书和证书颁发机构

数字证书时一个文件，其中包含了某个服务站点的名字和公钥，该证书由证书颁发机构（Certificate Authority）CA 颁发，这是一个付费服务。服务端会将自己的证书发送给客户端，客户端则会向 CA 验证证书的真实性，验证通过则会取出证书中的公钥使用。

证书是多层次的，站点的证书由某一颁发机构颁发，该颁发机构的证书又由一个更高级别的颁发机构所颁发，以此向上，最高级别的颁发机构的证书是内置在客户端中的。
