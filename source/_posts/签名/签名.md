---
title: 签名
date: 2023-12-13 10:58:19
updated: 2023-12-13 10:58:19
tags:
  - 签名
categories:
  - 笔记
---

# 参考资料

[签名验签 - 知乎 (zhihu.com)](https://zhuanlan.zhihu.com/p/457435473)

# 公私钥

公私钥并不都是向ssl中公钥用于加密，私钥用于解密，具体要看使用场景。

但有一点是不变的，就是从名字上看，公钥就是公开的，私钥就是自己留着的。

# 签名

对于签名来说，签名要完成的功能是，对一段信息进行计算，生成一段数据，这段数据需要简短，且对原始报文进行修改后，可以通过之前的签名发现报文被修改。将原始报文以及签名一并发给接收方后，接收方可以通过“验签”操作验证报文是否被修改。

之前一直以为签名由于数据变短，不可复原，所以使用的一定是单向加密，但今天了解e签宝原理时突然想到，如果是单向加密，那如何验签？假如签名算法暴露，那完全可以修改原文的同时修改密文，这样还是看不出来原文被修改。

# 原理

签名方持有一对公私钥，公钥公开，私钥自己持有。

签名方首先使用摘要算法对原始报文进行摘要，这段摘要操作是不可逆的，保证签名简短。

签名方使用私钥对摘要进行加密，获得签名。接着将原始报文，签名发给验签方。

验签方使用之前保存的公钥对签名进行解密，获取摘要1，接着使用同样的摘要算法对原文进行摘要获得摘要2，最后对比摘要1和摘要2的内容是否相同，若相同则说明原文在签名后未被修改。

# 验签方如何获取公钥

由于加密使用的私钥只有签名方持有，故中间人无法对文件进行修改后重新使用签名方的私钥进行签名，但有个漏洞，那就是如果签名方将原文、签名以及公钥一并发给验签方，那中间人完全可以中间拦截 ，使用自己的私钥进行签名，连带自己的公钥发给验签方，验签方如何得知签名被修改了呢。

故公钥不能被携带在报文中一并发给验签方，而是需要验签方提前获取，解决办法就是可以使用证书机制，验签方提前保存可信任证书机构，然后一层层通过可信任链的请求获取当前签名方的公钥。

# e签宝原理

[电子签名的实现技术原理-e签宝 (esign.cn)](https://www.esign.cn/c/2022-12-29/496350.shtml)

e签宝在用户盖上章的时候，会使用私钥将当前合同内容进行签名，并将签名保存到合同pdf文件中。如果要验证这份合同的有效性，则通过用户的真实身份从CA获取用户证书，从证书中提取公钥，使用公钥对pdf文件进行验签。